

/*
 * Stokes.c
 *
 * Code generation for function 'Stokes'
 *
 */

/* Include files */
#include "Stokes.h"
#include "Stokes_data.h"
#include "Stokes_initialize.h"
#include <math.h>

/* Function Definitions */
void Stokes(const double V[3], double F[6])
{
  static const double dv1[168] = {-73.2091576746494,
                                  -73.209157674651053,
                                  -24.301982196352427,
                                  -16.385780883873167,
                                  4.651919144584383,
                                  -5.6863163453990726,
                                  0.94954808972636173,
                                  -0.14768572878617417,
                                  -0.36861870417561921,
                                  -0.1159851279990915,
                                  0.034721324178166868,
                                  -0.077262244234225771,
                                  0.026841531425174515,
                                  -0.021847958307284317,
                                  0.0014251981105393584,
                                  -0.0020715140102339153,
                                  -0.00031243508867709411,
                                  -0.00031515887919497762,
                                  -2.3556471954757948E-5,
                                  -4.4232753455062019E-5,
                                  -1.6565752468758606E-5,
                                  4.93982345256699E-6,
                                  -4.8003708289882895E-6,
                                  -5.537461382484037E-7,
                                  5.9107901800554273E-7,
                                  -5.4513797272997921E-7,
                                  8.899325140999471E-8,
                                  -4.1677699843144084E-8,
                                  -1.1659495382873574E-8,
                                  1.4830534314844566E-9,
                                  -4.0292886284201394E-9,
                                  3.8798142720721429E-10,
                                  -5.7921447145312976E-10,
                                  3.0725432529306707E-10,
                                  -2.4454286252053352E-10,
                                  5.9071750028450268E-11,
                                  -3.6179507198537956E-11,
                                  2.3027974155181284E-11,
                                  -1.7839200759611544E-11,
                                  1.0393605284724489E-11,
                                  -7.7611888349693767E-13,
                                  -7.7611888349693979E-13,
                                  128.86129069636593,
                                  78.127344427833947,
                                  35.519614661187049,
                                  18.459623159347672,
                                  6.1702874964427821,
                                  9.6592268548810836,
                                  0.10621539461064922,
                                  1.331132430357669,
                                  1.1494789839506758,
                                  0.44173107193348587,
                                  0.18772364161547619,
                                  0.26688826074169697,
                                  0.00960498744172536,
                                  0.10945548434337447,
                                  0.015072304455906429,
                                  0.023837272835723441,
                                  0.0095438261651093915,
                                  0.0064507187872061434,
                                  0.0021015262543154787,
                                  0.001656308934370556,
                                  0.00063453232955862316,
                                  5.8044143645824092E-5,
                                  0.00028774593419018848,
                                  3.5726465668302871E-5,
                                  5.15967883699084E-6,
                                  5.268243188463646E-5,
                                  -2.9216413338213835E-6,
                                  9.6264071149878742E-6,
                                  3.6248183375751277E-6,
                                  1.1413458210230574E-6,
                                  1.5239736063460467E-6,
                                  1.3386902954109912E-7,
                                  2.8518178615191127E-7,
                                  -5.3658679648169561E-8,
                                  1.5373798992465085E-7,
                                  -1.5730213802078789E-8,
                                  3.7966006973782513E-8,
                                  -8.2714032259489912E-9,
                                  2.6546893696685091E-8,
                                  -1.1664674330402832E-8,
                                  5.4847743893925758E-9,
                                  3.4311638236596778E-9,
                                  -102.48382091156017,
                                  -54.669446197870023,
                                  -32.621936134599949,
                                  -19.990794484594836,
                                  -13.833316820647219,
                                  -9.8759382328162566,
                                  -4.4072905731008909,
                                  -3.7892310083645193,
                                  -2.772180328498099,
                                  -1.7538058927322346,
                                  -1.2943039518414927,
                                  -0.94879890605004147,
                                  -0.64189140056644289,
                                  -0.49425641555291894,
                                  -0.31493639968195475,
                                  -0.2351717662341134,
                                  -0.15839523853219778,
                                  -0.10561324018955645,
                                  -0.066272912998557115,
                                  -0.042598551309835114,
                                  -0.02495907357758043,
                                  -0.016925186488408846,
                                  -0.011565440281950641,
                                  -0.0059046732844270367,
                                  -0.00515236822552963,
                                  -0.0036021996581900181,
                                  -0.0019103327794623066,
                                  -0.0015952087877474817,
                                  -0.00095914996602445765,
                                  -0.00062075231076398662,
                                  -0.00039153484001024362,
                                  -0.0002008829368832219,
                                  -0.00014640633084313036,
                                  -0.00010125932507490074,
                                  -7.8741480262692486E-5,
                                  -4.6861683978378361E-5,
                                  -4.0124238647352135E-5,
                                  -2.7474337450775054E-5,
                                  -1.8263490253524051E-5,
                                  -7.6375856259985191E-6,
                                  -1.1036530593554161E-5,
                                  -3.172673089642072E-6,
                                  55.3,
                                  37.6,
                                  29.4,
                                  23.4,
                                  19.3,
                                  16.3,
                                  12.8,
                                  11.0,
                                  9.66,
                                  8.26,
                                  7.17,
                                  6.31,
                                  5.48,
                                  4.75,
                                  4.2,
                                  3.63,
                                  3.19,
                                  2.76,
                                  2.38,
                                  2.04,
                                  1.79,
                                  1.56,
                                  1.33,
                                  1.19,
                                  1.09,
                                  0.967,
                                  0.884,
                                  0.797,
                                  0.738,
                                  0.684,
                                  0.64,
                                  0.609,
                                  0.586,
                                  0.564,
                                  0.542,
                                  0.529,
                                  0.515,
                                  0.502,
                                  0.489,
                                  0.483,
                                  0.477,
                                  0.471};
  static const double dv[43] = {
      0.471,  0.702,  0.896,  1.13,   1.38,   1.63,   2.19,  2.62,   3.03,
      3.67,   4.4,    5.16,   6.27,   7.51,   8.95,   11.0,  13.3,   16.6,
      21.2,   27.5,   35.2,   46.8,   62.3,   79.8,   98.2,  125.0,  159.0,
      206.0,  254.0,  325.0,  411.0,  526.0,  656.0,  851.0, 1076.0, 1307.0,
      1610.0, 2036.0, 2540.0, 3254.0, 3804.0, 4686.0, 6003.0};
  double re_idx_0;
  double v_idx_0;
  double xloc;
  int b_i;
  int high_i;
  int i;
  int low_i;
  int low_ip1;
  int mid_i;
  if (!isInitialized_Stokes) {
    Stokes_initialize();
  }
  /* fprintf('Stokes\n') */
  for (i = 0; i < 6; i++) {
    F[i] = 0.0;
  }
  i = (int)n;
  if ((int)n - 1 >= 0) {
    v_idx_0 = sqrt((V[0] * V[0] + V[1] * V[1]) + V[2] * V[2]);
    re_idx_0 = 2.0 * r * v_idx_0 * 1.2 / nu;
  }
  for (b_i = 0; b_i < i; b_i++) {
    if (re_idx_0 > 0.47) {
      low_i = 0;
      low_ip1 = 2;
      high_i = 43;
      while (high_i > low_ip1) {
        mid_i = ((low_i + high_i) + 1) >> 1;
        if (re_idx_0 >= dv[mid_i - 1]) {
          low_i = mid_i - 1;
          low_ip1 = mid_i + 1;
        } else {
          high_i = mid_i;
        }
      }
      xloc = re_idx_0 - dv[low_i];
      xloc = -0.5 *
             (xloc * (xloc * (xloc * dv1[low_i] + dv1[low_i + 42]) +
                      dv1[low_i + 84]) +
              dv1[low_i + 126]) *
             3.1415926535897931 * (r * r) * 1.2 * (v_idx_0 * v_idx_0);
      F[0] = xloc * V[0] / v_idx_0;
      F[2] = xloc * V[1] / v_idx_0;
      F[4] = xloc * V[2] / v_idx_0;
    } else {
      xloc = -18.849555921538759 * r * nu;
      F[0] = xloc * V[0];
      F[2] = xloc * V[1];
      F[4] = xloc * V[2];
    }
  }
}

/* End of code generation (Stokes.c) */
